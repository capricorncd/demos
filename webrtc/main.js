!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Vue"),require("VueRouter"),require("ELEMENT")):"function"==typeof define&&define.amd?define(["Vue","VueRouter","ELEMENT"],t):"object"==typeof exports?exports.ZXWebRTC=t(require("Vue"),require("VueRouter"),require("ELEMENT")):e.ZXWebRTC=t(e.Vue,e.VueRouter,e.ELEMENT)}(window,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(c=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(c)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(s," */")),i=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([r]).join("\n")}var c,a,s;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(r[c]=!0)}for(var a=0;a<e.length;a++){var s=[].concat(e[a]);o&&r[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},function(t,n){t.exports=e},function(e,t,n){"use strict";var o,r=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),c=[];function a(e){for(var t=-1,n=0;n<c.length;n++)if(c[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},o=[],r=0;r<e.length;r++){var i=e[r],s=t.base?i[0]+t.base:i[0],u=n[s]||0,l="".concat(s," ").concat(u);n[s]=u+1;var d=a(l),f={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(c[d].references++,c[d].updater(f)):c.push({identifier:l,updater:m(f,t),references:1}),o.push(l)}return o}function u(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var r=n.nc;r&&(o.nonce=r)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var c=i(e.insert||"head");if(!c)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");c.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function f(e,t,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=d(t,r);else{var i=document.createTextNode(r),c=e.childNodes;c[t]&&e.removeChild(c[t]),c.length?e.insertBefore(i,c[t]):e.appendChild(i)}}function p(e,t,n){var o=n.css,r=n.media,i=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),i&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var h=null,v=0;function m(e,t){var n,o,r;if(t.singleton){var i=v++;n=h||(h=u(t)),o=f.bind(null,n,i,!1),r=f.bind(null,n,i,!0)}else n=u(t),o=p.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var r=a(n[o]);c[r].references--}for(var i=s(e,t),u=0;u<n.length;u++){var l=a(n[u]);0===c[l].references&&(c[l].updater(),c.splice(l,1))}n=i}}}},function(e,t,n){var o=n(2),r=n(13);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},function(e,t,n){var o=n(2),r=n(15);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},function(e,t,n){var o=n(2),r=n(21);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},function(e,t,n){var o=n(2),r=n(23);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},function(e,n){e.exports=t},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}},function(e,t){e.exports=n},function(e,t,n){var o=n(16),r=n(17),i=n(18),c=n(19);e.exports=function(e){return o(e)||r(e)||i(e)||c()}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";var o=n(3);n.n(o).a},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o)()(!1);r.push([e.i,"*{margin:0;padding:0}.el-header{position:relative;background:#545c64}.el-header .github-link{position:absolute;top:50%;right:20px;transform:translateY(-50%);opacity:0.6;font-size:0}.el-header .github-link:hover{opacity:1}\n",""]),t.default=r},function(e,t,n){"use strict";var o=n(4);n.n(o).a},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o)()(!1);r.push([e.i,".peer-connection-page-wrapper video{width:100%;height:300px;background:#ccc}\n",""]),t.default=r},function(e,t,n){var o=n(8);e.exports=function(e){if(Array.isArray(e))return o(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t,n){var o=n(8);e.exports=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";var o=n(5);n.n(o).a},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o)()(!1);r.push([e.i,".web-rtc-wrapper{text-align:center;font-family:Arial}.web-rtc-wrapper video{width:100%;height:auto}.web-rtc-wrapper .button-wrapper{margin-top:30px}\n",""]),t.default=r},function(e,t,n){"use strict";var o=n(6);n.n(o).a},function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o)()(!1);r.push([e.i,"",""]),t.default=r},function(e,t,n){"use strict";n.r(t);var o=n(1),r=n.n(o),i=n(9),c=n.n(i),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},e._l(e.menuItems,(function(t,o){return n("el-menu-item",{key:o,attrs:{index:o+""},on:{click:function(n){return e.handleMenuClick(t)}}},[e._v(e._s(t.text))])})),1),e._v(" "),n("a",{staticClass:"github-link",attrs:{href:"https://github.com/capricorncd/webrtc",target:"_blank"}},[n("svg",{attrs:{height:"24",viewBox:"0 0 16 16",version:"1.1",width:"24","aria-hidden":"true"}},[n("path",{attrs:{"fill-rule":"evenodd",fill:"#fff",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"}})])])],1),e._v(" "),n("el-main",[n("router-view")],1)],1)};a._withStripped=!0;var s={data:function(){var e=[{path:"/",text:"Home"},{path:"/peer-connection",text:"PeerConnection"},{path:"/live",text:"Live"},{path:"/chat-room",text:"ChatRoom"}],t=this.$route.path;return{activeIndex:e.findIndex((function(e){return e.path===t}))+"",menuItems:e}},methods:{handleMenuClick:function(e){this.$router.push(e.path)}}};n(12);function u(e,t,n,o,r,i,c,a){var s,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),c?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(c)},u._ssrRegister=s):r&&(s=a?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(u.functional){u._injectStyles=s;var l=u.render;u.render=function(e,t){return s.call(t),l(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,s):[s]}return{exports:e,options:u}}var l=u(s,a,[],!1,null,null,null);l.options.__file="src/App.vue";var d=l.exports,f=n(7),p=n.n(f),h=function(){var e=this.$createElement;this._self._c;return this._m(0)};h._withStripped=!0;var v=u({computed:{},data:function(){return{}},methods:{}},h,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"index-page-wrapper"},[t("h1",[this._v("WebRTC")])])}],!1,null,null,null);v.options.__file="src/pages/index.vue";var m=v.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"peer-connection-page-wrapper"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("h2",[e._v("Local")]),e._v(" "),n("Video",{on:{mounted:function(t){return e.v1=t}}})],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("h2",[e._v("Remote")]),e._v(" "),n("Video",{on:{mounted:function(t){return e.remoteVideo=t}}})],1)],1),e._v(" "),n("el-row",{staticStyle:{margin:"10px -10px 20px"},attrs:{gutter:20}},[n("el-col",{attrs:{span:24}},[n("el-button",{attrs:{type:"primary",disabled:e.isStared},on:{click:e.onStart}},[e._v("Start")]),e._v(" "),n("el-button",{attrs:{type:"success",disabled:!e.isStared||e.isCalled},on:{click:e.onCall}},[e._v("Call")]),e._v(" "),n("el-button",{attrs:{type:"danger",disabled:!e.isCalled},on:{click:e.onHangUp}},[e._v("Hang Up")])],1)],1),e._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("h2",[e._v("Offer SDP")]),e._v(" "),n("el-input",{attrs:{type:"textarea",readonly:"",rows:30,value:e.offerSDP}})],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("h2",[e._v("Answer SDP")]),e._v(" "),n("el-input",{attrs:{type:"textarea",readonly:"",rows:30,value:e.answerSDP}})],1)],1)],1)};g._withStripped=!0;var b=function(){var e=this.$createElement;return(this._self._c||e)("video",{ref:"video",attrs:{autoplay:"",playsinline:""}})};b._withStripped=!0;var y=u({computed:{video:function(){return this.$refs.video}},mounted:function(){var e=this;this.$nextTick((function(){e.$emit("mounted",e.$refs.video)}))}},b,[],!1,null,null,null);function _(e){return e.split(/\r\n/).join("\n")}y.options.__file="src/pages/peer-connection/video.vue";var w={components:{Video:y.exports},data:function(){return{isStared:!1,isCalled:!1,v1:null,remoteVideo:null,stream:null,pc1:null,pc2:null,offerSDP:"",answerSDP:""}},methods:{onStart:function(){var e=this;if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return console.error("The getUserMedia is not supported"),void this.$message.error("The getUserMedia is not supported");this.isStared=!0;navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){console.log("navigator.mediaDevices.getUserMedia"),e.getMediaStream(t)})).catch((function(t){e.isStared=!1,console.error(t),e.$message.error(t.message)}))},onCall:function(){var e=this;this.isCalled=!0,console.log("instance pc1, pc2"),this.pc1=new RTCPeerConnection,this.pc2=new RTCPeerConnection,this.pc1.onicecandidate=function(t){console.log("pc1.onicecandidate","pc2.addIceCandidate"),e.pc2.addIceCandidate(t.candidate)},this.pc2.onicecandidate=function(t){console.log("pc2.onicecandidate","pc1.addIceCandidate"),e.pc1.addIceCandidate(t.candidate)},this.pc2.ontrack=function(t){console.log("pc1.ontrack"),e.getRemoteStream(t.streams)},console.log("stream.getTracks"),this.stream.getTracks().forEach((function(t){console.log("pc1.addTrack",t),e.pc1.addTrack(t,e.stream)})),console.info("媒体协商开始");console.log("pc1.createOffer"),this.pc1.createOffer({offerToReceiveVideo:1,offerToReceiveAudio:0}).then((function(t){console.log("pc1 Offer",t),e.offerSDP=_(t.sdp),e.getOfferDesc(t)})).catch((function(t){e.isCalled=!1,console.error(t),e.$message.error(t.message)}))},onHangUp:function(){this.pc1&&this.pc1.close(),this.pc2&&this.pc2.close(),this.isCalled=!1},getMediaStream:function(e){console.log("set v1.srcObject"),this.v1.srcObject=e,this.stream=e},getRemoteStream:function(e){console.log("set remoteVideo.srcObject"),this.remoteVideo.srcObject=e[0]},getOfferDesc:function(e){var t=this;console.log("pc1.setLocalDescription"),this.pc1.setLocalDescription(e),this.pc2.setRemoteDescription(e),console.log("pc2.setRemoteDescription end"),console.log("pc2.createAnswer"),this.pc2.createAnswer().then((function(e){console.log("pc2 Answer",e),t.answerSDP=_(e.sdp),t.getAnswerDesc(e)})).catch((function(e){t.isCalled=!1,console.error(e),t.$message.error(e.message)}))},getAnswerDesc:function(e){console.log("pc2.setLocalDescription","pc1.setRemoteDescription"),this.pc2.setLocalDescription(e),this.pc1.setRemoteDescription(e),console.info("媒体协商结束")}}},x=(n(14),u(w,g,[],!1,null,null,null));x.options.__file="src/pages/peer-connection/index.vue";var R=x.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"web-rtc-wrapper"},[n("h1",[e._v("WebRTC Live")]),e._v(" "),n("video",{ref:"video",attrs:{autoplay:"",controls:""}}),e._v(" "),n("div",{staticClass:"button-wrapper"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleLive}},[e._v(e._s(e.liveBtnText))]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:e.handleRecord}},[e._v(e._s(e.recordBtnText))]),e._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:e.handlePlay}},[e._v("Play")]),e._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:e.handleDownload}},[e._v("Download")])],1)])};C._withStripped=!0;var S=n(10),O=n.n(S);function $(){this._eventList={}}$.prototype={constructor:$,on:function(e,t){if("function"!=typeof t)throw new Error("".concat(e,"'s handler is not a function \"").concat(t,'"'));this._eventList[e]||(this._eventList[e]=[]),this._eventList[e].push(t)},once:function(e,t){var n=this;return this.on(e,(function o(){for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];t.apply(void 0,i),n.off(e,o)})),this},emit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this._eventList[t[0]]){var o=t.slice(1);this._eventList[eventType].forEach((function(e){e.apply(void 0,O()(o))}))}},off:function(e,t){var n=this._eventList[e];if(n)if("function"==typeof t){var o=n.findIndex((function(e){return e===t}));n.splice(o,1)}else n.length=0}};var T=$,j=n(11),k=n.n(j);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){k()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M={type:"video/webm"};function E(e,t){var n=new Blob(e,L(L({},M),t));return window.URL.createObjectURL(n)}var P={width:640,height:360,frameRate:24,facingMode:"environment"};function A(e){this.stream=null,this.mediaRecorder=null,this.recorderBuffer=[],this.$video=e.video,this.constraints={video:P,audio:!1},this._init()}A.prototype=new T,A.prototype.constructor=A,A.prototype._init=function(){var e=this;navigator.mediaDevices.getUserMedia(this.constraints).then((function(t){e._getMediaStream(t)})).catch((function(t){e.emit("error",t)}))},A.prototype._getMediaStream=function(e){var t=this;this.stream=e,navigator.mediaDevices.enumerateDevices().then((function(e){t._getDevices(e)}))},A.prototype._getDevices=function(e){var t={};e.forEach((function(e){t[e.kind]||(t[e.kind]=[]),t[e.kind].push(e)})),console.log(t)},A.prototype.startLive=function(){this.$video.srcObject=this.stream},A.prototype.stopLive=function(){this.$video.srcObject=null},A.prototype.setConstraints=function(e,t){"string"==typeof e&&/^video|audio$/i.test(e)&&(this.constraints[e]=t)},A.prototype.startRecord=function(){var e=this;this.recorderBuffer=[];var t={mimeType:"video/webm;codecs=vp8"};if(MediaRecorder.isTypeSupported(t.mimeType)){try{this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(e){return void console.error("Failed to create MediaRecorder",e)}this.mediaRecorder.ondataavailable=function(t){e._onDataAvailable(t)},this.mediaRecorder.start(10)}else console.error("".concat(t.mimeType," is not supported!"))},A.prototype._onDataAvailable=function(e){e&&e.data&&e.data.size>0&&this.recorderBuffer.push(e.data)},A.prototype.stopRecord=function(){this.mediaRecorder&&this.mediaRecorder.stop()},A.prototype.play=function(){this.stopLive(),this.$video.src=E(this.recorderBuffer,{type:"video/webm"}),this.$video.play(),this.$video.controller=!0},A.prototype.canPlay=function(){return this.recorderBuffer.length>0},A.prototype.pause=function(){this.$video.pause(),this.$video.controller=!1},A.prototype.download=function(){var e=document.createElement("a");e.href=E(this.recorderBuffer,{type:"video/webm"}),e.download="record-".concat(+new Date,".webm"),e.click()},A.prototype.distroy=function(){this.stream=null,this.mediaRecorder=null,this.recorderBuffer=null,this.$video=null};var U=A,B={computed:{video:function(){return this.$refs.video},recordBtnText:function(){return this.isRecording?"Stop Record":"Start Record"},liveBtnText:function(){return this.isLiving?"Stop":"Start"},canPlay:function(){return this.webRtc&&this.webRtc.canPlay()}},data:function(){return{webRtc:null,isRecording:!1,isLiving:!1}},methods:{initWebRtc:function(){var e=this;this.$nextTick((function(){var t=new U({video:e.video});console.log(t),e.webRtc=t,e.webRtc.on("error",(function(e){console.error(e)}))}))},handleLive:function(){this.isLiving?this.webRtc.stopLive():this.webRtc.startLive(),this.isLiving=!this.isLiving},handleRecord:function(){this.isRecording?this.webRtc.stopRecord():(this.webRtc.startLive(),this.webRtc.startRecord()),this.isRecording=!this.isRecording},handlePlay:function(){this.webRtc.canPlay()?this.webRtc.play():this.$message.error("没有可播放数据")},handleDownload:function(){this.webRtc.canPlay()?this.webRtc.download():this.$message.error("没有可下载的数据")}},mounted:function(){this.initWebRtc()},beforeDestroy:function(){this.webRtc.distroy()}},I=(n(20),u(B,C,[],!1,null,null,null));I.options.__file="src/pages/live/index.vue";var N=I.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-room-page-wrapper"},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"用户名"}},[n("el-input",{model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"房间号"}},[n("el-row",[n("el-col",{attrs:{span:20}},[n("el-input",{model:{value:e.form.room,callback:function(t){e.$set(e.form,"room",t)},expression:"form.room"}})],1),e._v(" "),n("el-col",{staticStyle:{display:"flex","justify-content":"flex-end"},attrs:{span:4}},[n("el-button",{staticStyle:{flex:"1","margin-left":"20px"},attrs:{type:"primary",disabled:e.isConnected},on:{click:e.onConnect}},[e._v(e._s(e.connectBtnText))])],1)],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"聊天内容"}},[n("el-input",{attrs:{type:"textarea",rows:"10",readonly:""},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"输入"}},[n("el-input",{ref:"input",attrs:{type:"textarea"},model:{value:e.form.input,callback:function(t){e.$set(e.form,"input",t)},expression:"form.input"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSend}},[e._v("发送消息")])],1)],1)],1)};V._withStripped=!0;var q={name:"ChatRoom",computed:{connectBtnText:function(){return this.isConnected?"已链接":"链接服务器"},$input:function(){return this.$refs.input}},data:function(){return{form:{userName:"Tom",room:"100001",content:"",input:""},isConnected:!1,socket:null}},methods:{onConnect:function(){console.log("onConnect!"),this.isConnected?console.log("is connected!"):this._initSocket()},_initSocket:function(){var e=this,t=io("ws://capricorncd.com:8080");t.on("connect",(function(){e.socket=t,e.isConnected=!0})),t.on("disconnect",(function(){e.isConnected=!1})),t.on("chat message",(function(t){var n=t.room,o=t.user,r=t.id,i=t.data;n===e.form.room&&(e.form.content+="".concat(o,"(").concat(r,"):\n[").concat(i,"]\n"))}))},onSend:function(){if(this.isConnected){if(!this.form.input)return this.$message.error("请输入聊天内容!"),void this.$input.focus();this.socket.emit("chat message",{data:this.form.input,room:this.form.room,id:this.socket.id,user:this.form.userName}),this.form.input=""}else this.$message.error("don't connect to server")}}},H=(n(22),u(q,V,[],!1,null,null,null));H.options.__file="src/pages/chat-room/index.vue";var W=H.exports;r.a.use(p.a);var z=new p.a({routes:[{path:"/",component:m},{path:"/live",component:N},{path:"/peer-connection",component:R},{path:"/chat-room",component:W}]});r.a.use(c.a),new r.a({el:"#app",router:z,render:function(e){return e(d)}})}])}));